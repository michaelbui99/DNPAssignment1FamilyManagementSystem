@page "/Login"
@using DNPAssignment1FamilyManagementSystem.Authentication
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider AuthenticationStateProvider

<AuthorizeView>
    <NotAuthorized>
        
        
        
        <div class="login-container">
            
            <div class="left-section">
                <img src="images/Asset 860.png" alt="">
                <h4>
                    Family Management System
                </h4>
                <p>Keep track of all your families</p>
                
            </div>
            <div class="right-section">
                <h3>Login</h3>
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" placeholder="Username" @bind-value="_username"/>
                </div>

                <div class="form-group">
                    <label>Password</label>
                    <input type="password" placeholder="Password" @bind-value="_password">
                </div>

                <button>Login</button>
                <p>
                    Not registered yet? <span id="create-account-cta"> Create an account</span>
                </p>
            </div>
        </div>
    </NotAuthorized>
</AuthorizeView>


@code {
    private string _username;
    private string _password;
    
    [CascadingParameter] protected Task<AuthenticationState> AuthStat { get; set; }

    protected async override Task OnInitializedAsync()
    {
        //Redirects the user to index if user is already logged in.
        base.OnInitialized();
        var user = (await AuthStat).User;
        if (user.Identity.IsAuthenticated)
        {
            NavigationManager.NavigateTo("/");
        }
    }
}